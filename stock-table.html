<section id="stock-table" class="section">
  <div class="text-2xl font-semibold text-gray-800 mb-6">ðŸ“¦ Tableau du stock total</div>
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white rounded-xl shadow">
      <thead class="bg-[var(--color-primaire)] text-white">
        <tr>
          <th class="py-3 px-4 text-left">RÃ©fÃ©rence</th>
          <th class="py-3 px-4 text-left">DÃ©signation</th>
          <th class="py-3 px-4 text-left">QuantitÃ©</th>
          <th class="py-3 px-4 text-left">Emplacement</th>
          <th class="py-3 px-4 text-left">Prix HT</th>
        </tr>
      </thead>
      <tbody id="stockTableBody" class="text-gray-700 divide-y divide-gray-200">
      </tbody>
    </table>
  </div>

  <script>
    const SUPABASE_URL = "https://xkrpljsulrjsmtmkeefc.supabase.co";
    const SUPABASE_API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrcnBsanN1bHJqc210bWtlZWZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUyNTMxMDYsImV4cCI6MjA2MDgyOTEwNn0.r0-1UIWWs9esFIY3lc3Fz3IclRJSrPqx4D-hXvhOFvo";

    fetch(`${SUPABASE_URL}/rest/v1/stock`, {
      method: "GET",
      headers: {
        apikey: SUPABASE_API_KEY,
        Authorization: `Bearer ${SUPABASE_API_KEY}`,
        "Content-Type": "application/json"
      }
    })
      .then((res) => res.json())
      .then((data) => {
        const tbody = document.getElementById("stockTableBody");
        tbody.innerHTML = "";

        data.forEach((item) => {
          tbody.innerHTML += `
            <tr>
              <td class="py-3 px-4">${item.reference || ""}</td>
              <td class="py-3 px-4">${item.designation || ""}</td>
              <td class="py-3 px-4">${item.quantite || 0}</td>
              <td class="py-3 px-4">${item.emplacement || ""}</td>
              <td class="py-3 px-4">${item.prix_ht ? item.prix_ht.toFixed(2) + " â‚¬" : ""}</td>
            </tr>
          `;
        });
      })
      .catch((err) => {
        console.error("Erreur chargement Supabase :", err);
      });
  </script>
</section>
